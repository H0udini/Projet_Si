<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>

</head>

<body>
    <div id="root"></div>

    <script type='text/babel'>
        class FormationForm extends React.Component {
            constructor(props) {
                super(props);
                this.state = {
                    value: '',
                    error: null,
                    isLoaded: false,
                    retour: "debut"
                };

                this.handleChange = this.handleChange.bind(this);
                this.handleSubmit = this.handleSubmit.bind(this);
            }

            handleChange(event) {
                this.setState({value: event.target.value});
            }

            handleSubmit(event) {

                let query = "http://obiwan2.univ-brest.fr:8004/" + this.state.value + "/" + this.state.value;
                fetch(query)
                .then((res) => res.text())    
                .then(
                    (result) => {
                        console.log('result');
                        console.log(result);
                        this.setState({
                            isLoaded: true,
                            retour: result
                        });
                    },
                    (error) => {
                        console.log('erreur');
                        this.setState({
                            isLoaded: true,
                            error
                        });
                    }
                );
                

            }

            render() {
                return (
                <form onSubmit={this.handleSubmit}>
                    <label>
                        nom de la formation :
                        <input type="text" value={this.state.value} onChange={this.handleChange} />
                    </label>
                    <br />
                    <input type="submit" value="Recherche" />
                </form>
                );
            }
        }

        ReactDOM.render(<FormationForm />, document.getElementById('root'));
    </script>
</body>
</html>